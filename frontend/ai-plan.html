<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>AI Plan - IRON AI</title>
    <link rel="stylesheet" href="/static/styles.css" />
</head>
<body class="form-page">
    <div class="form-card" style="max-width:720px;">
        <h2>Create Plan Using AI</h2>
        <div class="muted-text" style="margin-bottom:16px;">Answer a few questions so we can tailor a program for you.</div>

        <div class="form-field">
            <label class="form-label" for="experience">Experience</label>
            <select id="experience" class="input">
                <option value="novice">novice</option>
                <option value="6_12">6–12 months</option>
                <option value="1_3">1–3 years</option>
                <option value="3_plus">3+ years</option>
            </select>
        </div>

        <div class="form-field">
            <label class="form-label" for="days">Days per week</label>
            <select id="days" class="input">
                <option value="3" selected>3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>

        <div class="form-field">
            <label class="form-label">Available equipment (check all that apply)</label>
            <div style="display:flex; gap:12px; flex-wrap:wrap;">
                <label><input type="checkbox" class="eq" value="barbell" /> barbell</label>
                <label><input type="checkbox" class="eq" value="dumbbell" /> dumbbell</label>
                <label><input type="checkbox" class="eq" value="machine" /> machine</label>
            </div>
        </div>

        <div class="form-field">
            <label class="form-label">Muscle priorities (up to 2, optional)</label>
            <div id="prio-group" style="display:grid; grid-template-columns: repeat(3, minmax(120px,1fr)); gap:8px;">
                <label><input type="checkbox" class="prio" value="legs" /> legs</label>
                <label><input type="checkbox" class="prio" value="back" /> back</label>
                <label><input type="checkbox" class="prio" value="chest" /> chest</label>
                <label><input type="checkbox" class="prio" value="shoulders" /> shoulders</label>
                <label><input type="checkbox" class="prio" value="arms" /> arms</label>
                <label><input type="checkbox" class="prio" value="core" /> core</label>
            </div>
            <div id="prio-hint" class="muted-text"></div>
        </div>

        <button class="primary-button" id="btn-generate">Generate Plan</button>
        <div id="ai-result" class="muted-text" style="margin-top:12px;"></div>
        <p class="muted-text" style="margin-top:16px;"><a class="link" href="/">Back to home</a></p>
    </div>

    <script>
    // limit priorities to 2
    const prioHint = document.getElementById('prio-hint');
    document.querySelectorAll('.prio').forEach(cb => {
      cb.addEventListener('change', () => {
        const selected = Array.from(document.querySelectorAll('.prio:checked'));
        if (selected.length > 2) {
          cb.checked = false;
          prioHint.textContent = 'You can select up to two priorities';
        } else {
          prioHint.textContent = '';
        }
      });
    });

    document.getElementById('btn-generate').addEventListener('click', async () => {
      const days = document.getElementById('days').value;
      const experience = document.getElementById('experience').value;
      const equipment = Array.from(document.querySelectorAll('.eq:checked')).map(x => x.value);
      const priorities = Array.from(document.querySelectorAll('.prio:checked')).map(x => x.value);

      const payload = { experience, days: Number(days), equipment, priorities };
      const res = document.getElementById('ai-result');
      res.textContent = 'Collected: ' + JSON.stringify(payload);
      // TODO: вызвать AI-эндпоинт для генерации плана и затем редирект на предпросмотр
    });
    </script>
</body>
</html>


